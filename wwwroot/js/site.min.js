$(function(){var n=$(".file-info-box"),t=$("#files_in");t.change(function(){var i,r,u;if(n.empty(),i=t[0].files,i.length>1)for(r=0;r<i.length;r++)u=$("<span/>").text(i[r].name),u.addClass("file-info"),n.append(u)})});$(function(){function i(i,r){var u=t.filter(n=>$(n).attr("data-name").toUpperCase().includes(i.toUpperCase())),e=u.length,o=e+" matching files found",f=$("<p>");br=$("<br>");f.text(o);r==="dsc"&&u.sort((n,t)=>{f1=$(n);f2=$(t);var i=f1.attr("data-year"),r=f1.attr("data-month"),u=f1.attr("data-day"),f=f1.attr("data-hour"),e=f1.attr("data-minute"),o=f1.attr("data-second"),s=f2.attr("data-year"),h=f2.attr("data-month"),c=f2.attr("data-day"),l=f2.attr("data-hour"),a=f2.attr("data-minute"),v=f2.attr("data-second");return d1=new Date(i,r,u,f,e,o),d2=new Date(s,h,c,l,a,v),d1-d2});n.append(f);n.append(br);u.forEach(t=>n.append(t))}const n=$("#filebox"),t=n.find("a.filename").toArray();$("#filesearch_btn").click(function(){var t=$("#filesearch_in").val(),r=$("input[name='date_in']:checked").val();n.empty();i(t,r)})});$(function(){function f(n){return(location.search.split(n+"=")[1]||"").split("&")[0]}var n=$("#textarea"),t=$("#titlein"),i=$("#submitbtn"),e=$("#tagsin"),r=$(".reply-btn"),u=f("open");dialog=$("#commentform").dialog({autoOpen:!1,width:600,height:500,resizable:!1,modal:!0});r.click(()=>dialog.dialog("open"));e.on("input selectionchange propertychange",function(){var i,r,t,n,u;if(realtags.length>19)$("#tagserr").text("Limit of 20 tags exceeded");else if(i=$(this).val(),i.endsWith(",")&&(r=/[`~!@#$%^&*()_|+=?;:'",.<>\{\}\[\]\\\/]/gi,t=i.slice(0,-1).trim().replace(r,""),t&&t.length))if(realtags.includes(t))$("#tagserr").text("Duplicate tags detected");else{$("#tagserr").empty();n=$("<div>");u=$(" <i class='fa fa-lg fa-hashtag' style='font-size:18px'><\/i> ");closeicon=$(" <i class='fa fa-times fa-xs' style='padding-left:5px;color:#911'><\/i> ");n.text(t);n.addClass("btn-tag");$("#tags-display-box").append(n);n.prepend(u);n.append(closeicon);$(this).val("");realtags.push(t);closeicon.on("click",()=>{var t=n.text();n.remove();realtags=realtags.filter(n=>n!==t);realtags.length<20&&$("#tagserr").empty()})}});n.on("input selectionchange propertychange",function(){n.val().trim().length&&t.val()&&t.val().trim().length?i.removeClass("disabled"):i.addClass("disabled")});t.on("input selectionchange propertychange",function(){t.val().trim().length&&n.val()&&n.val().trim().length?i.removeClass("disabled"):i.addClass("disabled")});u&&u.length&&r.click()});$(function(){function r(n,t){for(var i=0;i<n.length;i++)if(t.indexOf(n[i])===-1)return!1;return!0}var n=(n,t)=>{n===0?$("#commentcount").text("No "+comment_text):$("#commentcount").text("Showing "+n+" of "+t+" "+comment_text)},t=(n,t)=>{var i=$(n).find(".comment-date").text(),r=$(t).find(".comment-date").text(),u=new Date(i),f=new Date(r);return u-f},i=n=>{$(n).each((n,t)=>{content.append(t)})};content=$("#allcomments");allcomments=content.find(".comment").toArray();n(allcomments.length,allcomments.length);$("#searchbtn").click(function(){var f=$("input[name=Date]:checked").val(),u=$("#search_tags_in").val();text=$("#search_tt_in").val();commencountbox=$(".commentcount-box");uname=$("#search_uname_in").val();filteredcomments=allcomments;content.empty();allcomments.sort(t);f==="ascending"&&allcomments.reverse();u&&u.length&&(u=u.toLowerCase().split(","),filteredcomments=allcomments.filter(n=>r(u,$(n).attr("data-tags").split(","))));filteredcomments&&filteredcomments.length&&text&&text.length&&(filteredcomments=filteredcomments.filter(n=>($(n).attr("data-title")+$(n).find(".comment-text").text()).includes(text)));filteredcomments&&filteredcomments.length&&uname&&uname.length&&(filteredcomments=filteredcomments.filter(n=>$(n).find(".comment-uname").text()===uname));i(filteredcomments);n(filteredcomments.length,allcomments.length)})});$(function(){var n=$("#privacydialog"),t=$("#privacylink");n.dialog({autoOpen:!1,width:500,height:500,resizable:!1,modal:!0,buttons:{Ok:function(){$(this).dialog("close")}}});t.on("click",()=>n.dialog("open"))});$(()=>{var n=$(".alert");n.effect("highlight",{},3e3);n.parent().css("min-height",n.height()+10)});$(function(){var n={select_module:$("#input-module"),select_type:$("#input-gradetype"),in_grade:$("#input-grade"),in_week:$("#input-week"),in_date:$("form input[name=Year]"),error_box:$("div[data-valmsg-summary] > ul"),applydefaults:function(){this.select_module.val(module);this.select_type.prop("selected-index",0);this.in_grade.val(7);this.in_week.val(1);this.in_date.val(year)}},t=$("#modalform").dialog({autoOpen:!1,width:600,height:520,resizable:!1,modal:!0,open:()=>{n.applydefaults(),n.error_box.empty()}});$("form").submit(function(t){if(n.select_type.find("option:selected").text()==="Practical"&&(!n.in_week.val()||n.in_week.val()<0&&n.in_week.val()>13)){var i=$("<li><\/li>");return i.text("Enter a value for 'Week' between 1 and 13"),n.error_box.append(i),t.preventDefault(),!1}});$("#btn-modal").click(function(){t.dialog("open")})});var fillData=()=>{Object.keys(data).forEach(function(n){data[n].reports.length||data[n].reports.push(["_","_"])})};$(function(){select_module=$("#select-module");select_year=$("#select-year");btn_select=$(".header-box a");$(".alert").fadeOut(3500);modules.forEach(n=>{var t=$("<option><\/option>");t.attr("value",n);t.text(n);select_module.append(t)});years.forEach(n=>{var t=$("<option><\/option>");t.attr("value",n);t.text(n);select_year.append(t)});select_module.find("option[value='"+module+"']").attr("selected",!0);select_year.find("option[value='"+year+"']").attr("selected",!0);btn_select.click(()=>{var n=select_module.val(),t=select_year.val();return btn_select.attr("href","/Report/"+n+"/"+t),!0})});$(()=>{function e(n,t,r,f){i.title=n+" grades for "+module+" in "+year;var e=google.visualization.arrayToDataTable(t.reports,!0),o=new google.visualization.Histogram(r);o.draw(e,i);u(t,e,f)}function f(n,t){var i=t.newPanel,r=i.attr("id").split("-")[1];i.find("svg").length||(canvas=i[0].firstChild,loading_div=canvas.firstChild,info=canvas.nextSibling,$.when(e(r,data[r],canvas,$(info))).done(()=>loading_div.remove()))}var n=$("<div><\/div"),t=$("<ul><\/ul>"),i={legend:{position:"none"},height:"100%",width:"100%",colors:["#e7711c"],hAxis:{type:"category",title:"Grade"},vAxis:{title:"Frequency"}},r,u;$("#content").append(n);n.append(t);n.attr("id","tabs");t.addClass("tab-list");r=(n,t)=>Array(t-n+1).fill().map((t,i)=>n+i);u=(n,t,i)=>{var u=$("<div><\/div>"),e,s;if(info_content=u.clone(),count=+n.count,min=+n.min,u.addClass("chart-info-title"),info_content.addClass("chart-info-content"),i.append(u),i.append(info_content),count<min)e="s",count===1&&(e=""),i.addClass("nodata"),u.html(count+" submission"+e+" received.<br>To preserve anonymity, no data will be displayed until "+min+" submissions");else if(count===1)u.text("Displaying 1 submssion");else{var o=t.getNumberOfRows(),s,h=0,f=t.getColumnRange(1),c=(f.max+f.min)/2;r(1,o-1).forEach(n=>{h+=Math.pow(t.getValue(n,1)-c,2)});s=h/o;u.text("Displaying "+o+" submssions");info_content.html("Mean grade: "+c+"<br>Highest grade: "+f.max+"&emsp;Lowest grade: "+f.min+"<br>Variance: "+s.toFixed(1)+"&emsp;Ïƒ: "+Math.sqrt(s).toFixed(1))}};types.forEach(function(i){var r=$("<div><\/div>"),u=$("<div><\/div"),e=$("<div><\/div"),o=$("<div><\/div>"),f=$("<a><\/a>"),s="tab-"+i;list_item=$("<li><\/li>");f.text(i);t.append(list_item);u.addClass("canvas");o.addClass("chart-info");e.addClass("loader");list_item.append(f);r.attr("id",s);f.attr("href","#"+s);r.addClass("tab");r.append(u);r.append(o);n.append(r);u.append(e)});google.charts.load("current",{packages:["corechart"]});google.charts.setOnLoadCallback(function(){fillData();n.tabs({activate:f})});n.tabs({activate:f});setTimeout(()=>{$("a[href^='#tab']")[1].click(),$("a[href^='#tab']")[0].click()},1e3)});